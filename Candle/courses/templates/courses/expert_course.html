{% extends 'main/base.html' %}
{% load static %}

{% block title %}My Added Courses{% endblock %}

{% block content %}
<div class="container">
    {% if courses.count != 0 %}
        <div class="row m-3">
            {% for course in expert_courses %}
                <div class="col-md-4 mb-4">
                    <div class="card h-100">
                        <img  style=" object-fit: contain;" src="{{ course.image.url }}" class="card-img-top" alt="{{ course.title }}">
                        <div class="card-body d-flex justify-content-between">
                            <div>
                                <h4 class="card-title">{{ course.title }}</h4>
                                <p class="card-text">{{ course.description }}</p>
                                
                            </div>
                         
                        </div>
                        <div style="font-size:smaller" class="card-footer d-flex justify-content-between ">
                            <small class="text-muted">Added by:<img src="{{ course.user.expertprofile.avatar.url }}" alt="Avatar" width="20" height="20" class="rounded-circle">{{ course.user.first_name }} {{ course.user.last_name }}</small>
                            <small>{{course.addition_time}}</small>
                            
                        </div>
                        {% if request.user.is_authenticated and perms.courses.add_course and course.user.id == request.user.id %}
                        <div class="btn-group" role="group">
                            <a  href="{% url 'courses:update_course' course.id %}" class="btn btn-primary">Update</a>
                            <!-- Inside your for loop where the delete link is -->
<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#deleteCourseModal{{ course.id }}">Delete</button>

<!-- Modal for Delete Confirmation (each course has a unique modal id) -->
<div class="modal fade" id="deleteCourseModal{{ course.id }}" tabindex="-1" role="dialog" aria-labelledby="deleteCourseModalLabel{{ course.id }}" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteCourseModalLabel{{ course.id }}">Confirm Deletion</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this course?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <a href="{% url 'courses:delete_course' course.id %}" class="btn btn-danger">Delete</a>
            </div>
        </div>
    </div>
</div>

                        </div>
                        {% endif %}
                        <div class="text-center">
                            <a  href="{% url 'courses:course_detile_view' course.id %}" class="filter-link btn btn-light border-20  w-100">View Course detail</a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
    
        <div class="alert alert-info" role="alert">
            <p>There are no courses yet.</p>
            <a class="btn btn-sm btn-primary" href="{% url 'courses:add_course_view' %}">add course</a>
        </div>
    {% endif %}
</div>

{% endblock %}
